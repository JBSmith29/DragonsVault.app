{% set suffix = modal_suffix|default('') %}
{% set is_recommended = suffix.startswith('rec-') %}
{% set tag_label = commander.dominant_themes|first or 'All-rounder' %}
{% set modal_id = "commanderModal-" ~ suffix ~ (commander.card_id or loop.index0 or 0) %}
<div class="commander-card shadow-sm"
     data-name="{{ commander.name }}"
     data-score="{{ commander.synergy_score }}"
     data-tag="{{ (commander.dominant_themes|first or '') }}">
  <div class="commander-card__image position-relative">
    <img src="{{ commander.image_url or url_for('static', filename='img/card-placeholder.svg') }}"
         alt="{{ commander.name }}"
         class="w-100 h-100 object-fit-cover rounded-4">
    <span class="badge bg-primary commander-card__score">CRS {{ commander.synergy_score|round(1) }}</span>
  </div>
  <div class="commander-card__body">
    <div class="d-flex justify-content-between align-items-start gap-2">
      <div>
        <div class="fw-semibold commander-name">{{ commander.name }}</div>
        <div class="text-muted small commander-type">{{ commander.type_line }}</div>
      </div>
      {% set colors = commander.color_identity %}
      {% include "includes/_color_identity.html" %}
    </div>
    <div class="d-flex flex-column gap-2 mt-3">
      <div class="d-flex flex-wrap gap-2">
        <span class="badge text-bg-secondary">{{ tag_label }}</span>
      </div>
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-outline-light flex-grow-1 commander-why-btn"
                type="button"
                data-bs-toggle="modal"
                data-bs-target="#{{ modal_id }}">
          Why recommended?
        </button>
      </div>
    </div>
    <form method="post"
          action="{{ url_for('views.build_a_deck') }}"
          class="mt-2">
      <input type="hidden" name="commander_name" value="{{ commander.name }}">
      <input type="hidden" name="deck_name" value="Build: {{ commander.name }}">
      <input type="hidden" name="include_commander" value="1">
      <button class="btn btn-primary w-100" type="submit">
        Send to Build-A-Deck
      </button>
    </form>
    <form method="post"
          action="{{ url_for('views.build_recommended_deck') }}"
          class="mt-2">
      <input type="hidden" name="commander_name" value="{{ commander.name }}">
      <button class="btn btn-success w-100" type="submit">
        Build full deck from my cards
      </button>
    </form>
  </div>
</div>

{% set modal_suffix = suffix %}
{% include "includes/_commander_synergy_modal.html" %}
