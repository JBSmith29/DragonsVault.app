{% extends "base.html" %}

{% block title %}Opening Hand - DragonsVault{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="d-flex flex-wrap align-items-center justify-content-between gap-3 mb-4">
    <div>
      <h1 class="h2 mb-1">Opening Hand Simulator</h1>
      <p class="text-muted mb-0">Pick a saved deck or proxy build to shuffle, draw, and play out your opening hand on a dedicated board.</p>
    </div>
  </div>

  <form method="post"
        action="{{ url_for('views.opening_hand_play') }}"
        class="row g-4"
        id="openingHandStartForm"
        data-hx-boost="false">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

    <div class="col-12 col-lg-5">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title mb-2">Use a saved deck or proxy build</h5>
          <p class="text-muted small mb-3">Choose one of your decks or proxy builds to build the draw pile automatically.</p>

          <label class="form-label small text-muted">Deck</label>
          <div class="dropdown dv-select w-100" data-dv-select="opening-deck">
            <input type="hidden" name="deck_id" id="openingHandDeckId" data-dv-select-input value="">
            <button class="btn dv-select-toggle w-100 justify-content-between" type="button" id="openingHandDeckToggle" data-bs-toggle="dropdown" aria-expanded="false" aria-labelledby="openingHandDeckToggle">
              <span data-dv-select-label>Select a deck</span>
              <i class="bi bi-chevron-down"></i>
            </button>
            <ul class="dropdown-menu dv-select-menu w-100" aria-labelledby="openingHandDeckToggle">
              <li class="dv-select-search-wrapper">
                <input type="text"
                       class="form-control form-control-sm dv-select-search"
                       placeholder="Search decks"
                       autocomplete="off"
                       data-dv-select-search>
              </li>
              <li>
                <button class="dropdown-item active" type="button" data-dv-select-option data-value="" data-label="Select a deck">Select a deck</button>
              </li>
              {% for deck in deck_options %}
                <li>
                  <button class="dropdown-item" type="button" data-dv-select-option data-value="{{ deck.id }}" data-label="{{ deck.name }}">{{ deck.name }}</button>
                </li>
              {% endfor %}
            </ul>
          </div>
          <div class="form-text">Commanders stored with the deck or build are automatically excluded.</div>
        </div>
      </div>
    </div>

    <div class="col-12 col-lg-7">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title mb-2">Paste a deck list</h5>
          <p class="text-muted small mb-3">Use a list if the deck is not saved yet.</p>

          <label for="openingHandDeckList" class="form-label small text-muted">Deck list</label>
          <textarea id="openingHandDeckList" name="deck_list" class="form-control" rows="7" placeholder="7 Island&#10;1 Sol Ring&#10;1 Rhystic Study"></textarea>
          <div class="form-text mt-2">Quantities like "2 Lightning Bolt" or "2x Lightning Bolt" are supported.</div>

          <label for="openingHandCommander" class="form-label small text-muted mt-3">Commander name (optional)</label>
          <input type="text" id="openingHandCommander" name="commander_name" class="form-control" placeholder="Commander name(s) to exclude">
          <div class="form-text mt-2">Use "//" between partner commanders.</div>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
        <div class="text-muted small" id="openingHandHelp">Select a deck or paste a list to continue.</div>
        <button class="btn btn-primary" type="submit" id="openingHandStartBtn" disabled>Start Opening Hand</button>
      </div>
    </div>
  </form>
</div>

<script src="{{ static_url('js/opening-hand-landing.js') }}" defer></script>
{% endblock %}
